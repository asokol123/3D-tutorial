# Системы сборки C++

Исторически у `C++` нет единого станарта системы сборки, поэтому есть много разных.

* `CMake`
* `Bazel`
* `GNU Makefile`
* `ya.make` (проприетарная от Yandex)
* `gn`(? проприетарная от Google, используется в chromium)

## CMake
Самая популярная среди open-source проектов, система сборки по умолчанию в `CLion`

* Относительно простая
* Требует мало файлоа для конфигурации
* Интегрирована со множеством утилит
* Достаточно гибкая

Что необходимо знать чтобы сделать такой проект:
* Файлы конфигурации - `CMakeLists.txt` Цель - собираемая единица. Так в данном проекте есть цель `3D` - статическая библиотека и есть цель `tests` - исполняемый файл.
* Есть переменные и области видимости
* Можно добавлять подпапки (удобно для разделения)
* Есть интеграция с `conan`

Классический сценарий использования выглядит так:
```bash
mkdir build
cd build
cmake -DCMAKE_BUILD_TYPE=Release ..
make
make install
```

## Bazel
Набирает популярность, но намного сложнее `CMake` в освоении и требует больше конфигурации.

* Поддерживает распределенную сборку
* Настраивается на любой вкус
* Сложная в настройке, требует большого количества файлов и достаточно много абстракции

## GNU Makefile
Руками пишем команды для компилятора.

Настоятельно не рекомендуется использовать для хоть немного больших проектов, потому что очень быстро превращается в неструктурированный хаос, в котором невозможно разобраться и который невозможно рефакторить.

Основной объект - цель. Как правило выделяют три цели:

* all - собирает все необходимые файлы
* install - устанавливает скомпилированные файлы по нужным путям
* clean - очищает получившиеся в результате компиляции файлы, например кодогенерированные или `.o`

Таким образом использование часто выглядит как
```bash
make
make install
make clean
```

## ya.make
Одна из демонстраций что не существует хорошей системы сборки для `C++`, и все компании пишут свою.

Частично доступна в открытом доступе:

### Catboost
Поскольку `catbosot` - проект яндекса, в нем содержится достаточно большая часть стандартной библиотеки яндекса и система сборки `ya make`.

Есть отдельный [доклад](https://habr.com/ru/company/yandex/blog/458790/) про то, как разрабатывать `catbosot`, в нем есть и про систему сборки, и про стандартную библиотеку.

* Распределенная
* Закрытая

## gn

Система сборки от `google`. Из `open-source` проектов используется в `chromium`.

[Документация](https://gn.googlesource.com/gn/)

* Распределенная
* Непопулярная вне `google`